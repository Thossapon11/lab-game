<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏Å‡∏°‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢ - ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Kanit', sans-serif; }
        
        .beaker {
            background: linear-gradient(to bottom, transparent 0%, transparent 70%, #fff 70%, #fff 100%);
            border: 3px solid #374151;
            border-radius: 0 0 50px 50px;
            position: relative;
            background: #fff;
        }
        
        .solution {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            border-radius: 0 0 47px 47px;
            transition: all 0.5s ease;
        }
        
        .measuring-cylinder {
            background: linear-gradient(to right, #f3f4f6 0%, #e5e7eb 50%, #f3f4f6 100%);
            border: 2px solid #374151;
            border-radius: 10px 10px 5px 5px;
            position: relative;
            transform-origin: bottom;
            transition: transform 0.2s ease-in-out;
        }
        
        .measuring-cylinder.shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both infinite;
        }
        
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0) rotate(-1deg); }
            20%, 80% { transform: translate3d(2px, 0, 0) rotate(2deg); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0) rotate(-4deg); }
            40%, 60% { transform: translate3d(4px, 0, 0) rotate(4deg); }
        }
        
        .scale-mark {
            border-top: 1px solid #6b7280;
            width: 20px;
            position: absolute;
            right: 0;
        }
        
        .powder-particle {
            border-radius: 50%;
            position: absolute;
            animation: fall 1.5s forwards;
            background: radial-gradient(circle, #fbbf24 0%, #f59e0b 100%);
        }
        
        @keyframes fall {
            from { transform: translateY(0); opacity: 1; }
            to { transform: translateY(120px); opacity: 1; }
        }
        
        .stirring-rod {
            background: linear-gradient(to bottom, #8b5cf6 0%, #7c3aed 100%);
            border-radius: 50px;
            transform-origin: center center;
            transition: all 0.5s ease;
            position: absolute;
            width: 2px;
            height: 96px;
            left: 50%;
            transform: translateX(-50%) rotate(0deg);
            bottom: 30%;
        }
        
        .stirring-rod.active {
            animation: stir 1s ease-in-out infinite;
        }
        
        @keyframes stir {
            0% { transform: translateX(-50%) translateY(0) rotate(-10deg); }
            50% { transform: translateX(-50%) translateY(-5px) rotate(10deg); }
            100% { transform: translateX(-50%) translateY(0) rotate(-10deg); }
        }

        /* Modal specific styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-indigo-800 mb-2">üß™ ‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô</h1>
            <p class="text-lg text-gray-600">‡πÄ‡∏Å‡∏°‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢ - ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°</p>
        </div>

        <div class="max-w-6xl mx-auto bg-white rounded-2xl shadow-2xl overflow-hidden">
            <div class="bg-indigo-600 p-4">
                <div class="flex justify-between items-center text-white mb-2">
                    <span class="font-semibold">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</span>
                    <span id="progress-text">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1/5</span>
                </div>
                <div class="w-full bg-indigo-400 rounded-full h-3">
                    <div id="progress-bar" class="bg-yellow-400 h-3 rounded-full transition-all duration-500" style="width: 20%"></div>
                </div>
            </div>

            <div class="p-6">
                <div id="step-1" class="step-content">
                    <h2 class="text-2xl font-bold text-indigo-800 mb-4">üìã ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤</h2>
                    <div class="bg-blue-50 p-6 rounded-xl mb-6">
                        <h3 class="text-xl font-semibold mb-4">üéØ ‡πÇ‡∏à‡∏ó‡∏¢‡πå: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢</h3>
                        <div class="mb-6">
                            <label class="block text-sm font-medium mb-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏à‡∏ó‡∏¢‡πå</label>
                            <select id="compound-select" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500" onchange="updateProblem()">
                                <option value="NaCl">‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° NaCl 0.5 M ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ 250 mL</option>
                                <option value="KMnO4">‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° KMnO4 0.2 M ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ 500 mL</option>
                                <option value="CuSO4">‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà 3: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° CuSO4¬∑5H2O 0.3 M ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ 300 mL</option>
                                <option value="NaOH">‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà 4: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° NaOH 0.1 M ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ 1000 mL</option>
                                <option value="HCl">‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà 5: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° HCl 0.25 M ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ 400 mL</option>
                            </select>
                        </div>
                        
                        <div id="problem-display" class="grid md:grid-cols-2 gap-6 mb-6">
                            <div class="bg-white p-4 rounded-lg border-2 border-blue-300">
                                <h4 class="font-semibold text-blue-800 mb-3">üìù ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î</h4>
                                <div class="space-y-2">
                                    <div class="flex justify-between">
                                        <span>‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö:</span>
                                        <span id="display-compound" class="font-semibold">NaCl</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:</span>
                                        <span id="display-molarity" class="font-semibold">0.5 M</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:</span>
                                        <span id="display-volume" class="font-semibold">250 mL</span>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-yellow-50 p-4 rounded-lg border-2 border-yellow-300">
                                <h4 class="font-semibold text-yellow-800 mb-3">üìö ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ</h4>
                                <div id="compound-info">
                                    <p class="text-sm"><span id="compound-details">NaCl ‡∏°‡∏µ‡∏°‡∏ß‡∏•‡πÇ‡∏°‡πÄ‡∏•‡∏Å‡∏∏‡∏• = 58.44 g/mol</span></p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <div></div>
                            <button onclick="nextStep(2)" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors">
                                ‡πÑ‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì üßÆ
                            </button>
                        </div>
                    </div>
                </div>

                <div id="step-2" class="step-content hidden">
                    <h2 class="text-2xl font-bold text-indigo-800 mb-4">üßÆ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</h2>
                    <div class="bg-green-50 p-6 rounded-xl mb-6">
                        <h3 class="text-xl font-semibold mb-4">üìê ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏ß‡∏•‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-white p-4 rounded-lg">
                                <h4 class="font-semibold mb-3">üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÇ‡∏à‡∏ó‡∏¢‡πå</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>‡∏™‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö:</span>
                                        <span id="calc-compound" class="font-semibold">NaCl</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô (M):</span>
                                        <span id="calc-molarity" class="font-semibold">0.5</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ (mL):</span>
                                        <span id="calc-volume" class="font-semibold">250</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>‡∏°‡∏ß‡∏•‡πÇ‡∏°‡πÄ‡∏•‡∏Å‡∏∏‡∏• (g/mol):</span>
                                        <span id="calc-mw" class="font-semibold">58.44</span>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-blue-50 p-4 rounded-lg">
                                <h4 class="font-semibold mb-3">üßÆ ‡πÄ‡∏ï‡∏¥‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á</h4>
                                <div class="space-y-4 text-sm">
                                    <div class="bg-white p-3 rounded border">
                                        <p class="mb-2">1. ‡πÅ‡∏õ‡∏•‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏¥‡∏ï‡∏£:</p>
                                        <p>
                                            <input type="number" id="volume-input" class="inline-block w-20 p-1 border rounded text-center" step="0.001" placeholder=""> mL √∑ 1000 = 
                                            <input type="number" id="volume-liters" class="inline-block w-20 p-1 border rounded text-center" step="0.001" placeholder=""> L
                                        </p>
                                    </div>
                                    
                                    <div class="bg-white p-3 rounded border">
                                        <p class="mb-2">2. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÇ‡∏°‡∏•:</p>
                                        <p>
                                            <input type="number" id="molarity-input" class="inline-block w-20 p-1 border rounded text-center" step="0.1" placeholder=""> √ó 
                                            <input type="number" id="volume-for-moles" class="inline-block w-20 p-1 border rounded text-center" step="0.001" placeholder=""> = 
                                            <input type="number" id="moles-calc" class="inline-block w-20 p-1 border rounded text-center" step="0.0001" placeholder=""> mol
                                        </p>
                                    </div>
                                    
                                    <div class="bg-white p-3 rounded border">
                                        <p class="mb-2">3. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏°‡∏ß‡∏•‡∏™‡∏≤‡∏£:</p>
                                        <p>
                                            <input type="number" id="moles-for-mass" class="inline-block w-20 p-1 border rounded text-center" step="0.0001" placeholder=""> √ó 
                                            <input type="number" id="mw-input" class="inline-block w-24 p-1 border rounded text-center" step="0.01" placeholder=""> = 
                                            <input type="number" id="mass-calc" class="inline-block w-24 p-1 border rounded text-center" step="0.01" placeholder=""> g
                                        </p>
                                    </div>
                                    
                                    <button onclick="checkCalculation()" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-semibold transition-colors">
                                        ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div id="calculation-feedback" class="mt-4 hidden"></div>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <button onclick="previousStep(1)" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                            ‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
                        </button>
                        <button id="next-btn-calc" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors hidden" onclick="nextStep(3)">
                            ‡πÑ‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ä‡∏±‡πà‡∏á‡∏™‡∏≤‡∏£ ‚öñÔ∏è
                        </button>
                    </div>
                </div>

                <div id="step-3" class="step-content hidden">
                    <h2 class="text-2xl font-bold text-indigo-800 mb-4">‚öñÔ∏è ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏ä‡∏±‡πà‡∏á‡∏™‡∏≤‡∏£</h2>
                    
                    <div class="grid md:grid-cols-2 gap-8 mb-6">
                        <div>
                            <div class="bg-gray-100 p-6 rounded-xl">
                                <h3 class="text-lg font-semibold mb-4">‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ä‡∏±‡πà‡∏á‡∏î‡∏¥‡∏à‡∏¥‡∏ï‡∏≠‡∏•</h3>
                                <div class="bg-black text-green-400 p-4 rounded-lg font-mono text-2xl text-center mb-4">
                                    <span id="scale-display">0.00 g</span>
                                </div>
                                <div class="text-center mb-4">
                                    <div class="inline-block bg-gray-300 w-32 h-32 rounded-lg relative">
                                        <div id="powder-on-scale" class="absolute inset-4 bg-yellow-200 rounded-lg opacity-0 transition-opacity duration-500"></div>
                                    </div>
                                </div>
                                <button onclick="addPowder()" class="w-full bg-yellow-500 hover:bg-yellow-600 text-white py-2 rounded-lg font-semibold transition-colors">
                                    ‡πÄ‡∏ï‡∏¥‡∏°‡∏ú‡∏á‡∏™‡∏≤‡∏£
                                </button>
                            </div>
                        </div>
                        <div>
                            <div class="bg-blue-50 p-6 rounded-xl">
                                <h3 class="text-lg font-semibold mb-4">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</h3>
                                <div class="text-3xl font-bold text-indigo-600 mb-2">
                                    <span id="required-mass">0.00</span> g
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
                                    <div id="weighing-progress" class="bg-green-500 h-4 rounded-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                                <div id="weighing-status" class="text-center text-gray-600">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ä‡∏±‡πà‡∏á‡∏™‡∏≤‡∏£</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <button onclick="previousStep(2)" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                            ‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
                        </button>
                        <button id="next-btn-weighing" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors hidden" onclick="nextStep(4)">
                            ‡πÑ‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏™‡∏≤‡∏£ üåä
                        </button>
                    </div>
                </div>

                <div id="step-4" class="step-content hidden">
                    <h2 class="text-2xl font-bold text-indigo-800 mb-4">üåä ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏™‡∏≤‡∏£</h2>
                    
                    <div class="grid md:grid-cols-2 gap-8 mb-6">
                        <div>
                            <div class="bg-gray-100 p-6 rounded-xl">
                                <h3 class="text-lg font-semibold mb-4">üß™ ‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏™‡∏≤‡∏£</h3>
                                <div class="text-sm text-gray-600 mb-4 p-3 bg-blue-50 rounded-lg">
                                    üí° <strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢<br>
                                    ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÑ‡∏î‡πâ
                                </div>
                                <div class="relative">
                                    <div class="beaker w-32 h-40 mx-auto mb-4 relative">
                                        <div id="solution-level" class="solution bg-blue-200" style="height: 0%;"></div>
                                        <div id="powder-particles" class="absolute inset-0"></div>
                                        
                                        <div id="stirring-rod" class="stirring-rod absolute w-2 h-24 left-1/2 transform -translate-x-1/2 -top-4"></div>
                                    </div>
                                    
                                    <div id="dissolving-status" class="text-center text-gray-600 mb-4">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏™‡∏≤‡∏£</div>
                                    
                                    <div class="grid grid-cols-3 gap-2">
                                        <button id="add-salt-btn" onclick="addSalt()" class="bg-yellow-500 hover:bg-yellow-600 text-white py-2 px-3 rounded text-sm font-semibold transition-colors">
                                            üßÇ ‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≤‡∏£
                                        </button>
                                        <button id="add-water-btn" onclick="addWater()" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-3 rounded text-sm font-semibold transition-colors" disabled>
                                            üíß ‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥
                                        </button>
                                        <button id="stir-solution-btn" onclick="stirSolution()" class="bg-purple-500 hover:bg-purple-600 text-white py-2 px-3 rounded text-sm font-semibold transition-colors" disabled>
                                            ü•Ñ ‡∏Ñ‡∏ô
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="bg-orange-50 p-6 rounded-xl">
                                <h4 class="text-lg font-semibold text-orange-800 mb-3">‚ùì ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢</h4>
                                <p class="mb-4">‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏™‡∏≤‡∏£‡∏Ç‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡πÉ‡∏î?</p>
                                <div class="space-y-2">
                                    <label class="flex items-center cursor-pointer hover:bg-orange-100 p-2 rounded">
                                        <input type="radio" name="q1" value="a" class="mr-2">
                                        <span>A) ‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥ ‚Üí ‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≤‡∏£ ‚Üí ‡∏Ñ‡∏ô ‚Üí ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer hover:bg-orange-100 p-2 rounded">
                                        <input type="radio" name="q1" value="b" class="mr-2">
                                        <span>B) ‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≤‡∏£ ‚Üí ‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥ ‚Üí ‡∏Ñ‡∏ô ‚Üí ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer hover:bg-orange-100 p-2 rounded">
                                        <input type="radio" name="q1" value="c" class="mr-2">
                                        <span>C) ‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡∏Ñ‡∏£‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ ‚Üí ‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≤‡∏£ ‚Üí ‡∏Ñ‡∏ô</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer hover:bg-orange-100 p-2 rounded">
                                        <input type="radio" name="q1" value="d" class="mr-2">
                                        <span>D) ‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≤‡∏£ ‚Üí ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ ‚Üí ‡∏Ñ‡∏ô</span>
                                    </label>
                                </div>
                                <div class="mt-4">
                                    <button onclick="checkAnswer(1)" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                                        ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
                                    </button>
                                </div>
                                <div id="q1-feedback" class="mt-4 hidden"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <button onclick="previousStep(3)" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                            ‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
                        </button>
                        <button id="next-btn-1" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors hidden" onclick="nextStep(5)">
                            ‡πÑ‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ üìè
                        </button>
                    </div>
                </div>

                <div id="step-5" class="step-content hidden">
                    <h2 class="text-2xl font-bold text-indigo-800 mb-4">üìè ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 5: ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£</h2>
                    
                    <div class="grid md:grid-cols-2 gap-8 mb-6">
                        <div>
                            <div class="bg-gray-100 p-6 rounded-xl">
                                <h3 class="text-lg font-semibold mb-4">üß™ ‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£</h3>
                                <div class="text-sm text-gray-600 mb-4 p-3 bg-blue-50 rounded-lg">
                                    üí° <strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£<br>
                                    ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡πÑ‡∏î‡πâ
                                </div>
                                <div class="relative">
                                    <div id="volumetric-flask" class="measuring-cylinder w-24 h-48 mx-auto mb-4 relative">
                                        <div id="final-solution" class="solution bg-blue-200" style="height: 0%;"></div>
                                        
                                        <div class="scale-mark" style="top: 20%;"></div>
                                        <div class="scale-mark" style="top: 40%;"></div>
                                        <div class="scale-mark" style="top: 60%;"></div>
                                        <div class="scale-mark" style="top: 80%;"></div>
                                        
                                        <div class="absolute right-6 text-xs" style="top: 18%;">
                                            <span id="target-volume-label">250</span> mL
                                        </div>
                                        <div class="absolute right-6 text-xs" style="top: 38%;">200 mL</div>
                                        <div class="absolute right-6 text-xs" style="top: 58%;">150 mL</div>
                                        <div class="absolute right-6 text-xs" style="top: 78%;">100 mL</div>
                                        
                                        <div id="meniscus-line" class="absolute w-full border-t-2 border-red-500 opacity-0 transition-opacity duration-500" style="top: 20%;"></div>
                                    </div>
                                    
                                    <div class="text-center mb-2">
                                        <div class="text-lg font-semibold">
                                            ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span id="current-volume">0</span> mL
                                        </div>
                                        <div class="text-sm text-gray-600">
                                            ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: <span id="target-volume-display">250</span> mL
                                        </div>
                                    </div>
                                    
                                    <div id="final-status" class="text-center text-gray-600 mb-4">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£</div>
                                    
                                    <div class="grid grid-cols-3 gap-2">
                                        <button onclick="transferSolution()" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-3 rounded text-sm font-semibold transition-colors">
                                            üîÑ ‡∏¢‡πâ‡∏≤‡∏¢‡∏™‡∏≤‡∏£
                                        </button>
                                        <button onclick="addMoreWater()" class="bg-cyan-500 hover:bg-cyan-600 text-white py-2 px-3 rounded text-sm font-semibold transition-colors">
                                            üíß ‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥
                                        </button>
                                        <button id="final-mix-btn" onclick="finalMix()" class="bg-green-500 hover:bg-green-600 text-white py-2 px-3 rounded text-sm font-semibold transition-colors">
                                            üåÄ ‡∏Ñ‡∏ô‡∏ú‡∏™‡∏°
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <div class="bg-orange-50 p-6 rounded-xl">
                                <h4 class="text-lg font-semibold text-orange-800 mb-3">‚ùì ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: Volumetric Flask</h4>
                                <p class="mb-4">‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ ‡πÄ‡∏´‡∏ï‡∏∏‡πÉ‡∏î‡∏à‡∏∂‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Volumetric Flask ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢?</p>
                                <div class="space-y-2">
                                    <label class="flex items-center cursor-pointer hover:bg-orange-100 p-2 rounded">
                                        <input type="radio" name="q2" value="a" class="mr-2">
                                        <span>A) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer hover:bg-orange-100 p-2 rounded">
                                        <input type="radio" name="q2" value="b" class="mr-2">
                                        <span>B) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer hover:bg-orange-100 p-2 rounded">
                                        <input type="radio" name="q2" value="c" class="mr-2">
                                        <span>C) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer hover:bg-orange-100 p-2 rounded">
                                        <input type="radio" name="q2" value="d" class="mr-2">
                                        <span>D) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏™‡∏≤‡∏£‡πÄ‡∏Ñ‡∏°‡∏µ</span>
                                    </label>
                                </div>
                                <div class="mt-4">
                                    <button onclick="checkAnswer(2)" class="bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                                        ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
                                    </button>
                                </div>
                                <div id="q2-feedback" class="mt-4 hidden"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-between items-center">
                        <button onclick="previousStep(4)" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-semibold transition-colors">
                            ‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
                        </button>
                        <button id="next-btn-2" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors hidden" onclick="showCompletion()">
                            ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô üéâ
                        </button>
                    </div>
                </div>

                <div id="completion-modal" class="modal hidden">
                    <div class="modal-content">
                        <div class="text-center py-6">
                            <div class="text-6xl mb-4">üéâ</div>
                            <h2 class="text-3xl font-bold text-green-600 mb-4">‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏°‡∏≤‡∏Å! ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</h2>
                            <div class="bg-green-50 p-6 rounded-xl max-w-md mx-auto mb-6">
                                <h3 class="text-xl font-semibold mb-4">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</h3>
                                <div id="final-results" class="space-y-2 text-left"></div>
                                <div id="score-display" class="mt-4 p-4 bg-yellow-100 rounded-lg">
                                    <div class="text-lg font-semibold">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: <span id="total-score">0</span>/5</div>
                                </div>
                            </div>
                            <button onclick="resetGame()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-8 py-3 rounded-lg font-semibold transition-colors">
                                üîÑ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        const compounds = {
            'NaCl': {
                name: '‡πÇ‡∏ã‡πÄ‡∏î‡∏µ‡∏¢‡∏°‡∏Ñ‡∏•‡∏≠‡πÑ‡∏£‡∏î‡πå',
                mw: 58.44,
                molarity: 0.5,
                volume: 250,
                color: '#3b82f6',
                powderColor: '#fbbf24',
                description: '‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡πÅ‡∏Å‡∏á - ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∏‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°'
            },
            'KMnO4': {
                name: '‡πÇ‡∏õ‡πÅ‡∏ï‡∏™‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÅ‡∏°‡∏á‡∏Å‡∏≤‡πÄ‡∏ô‡∏ï',
                mw: 158.03,
                molarity: 0.2,
                volume: 500,
                color: '#7c2d92',
                powderColor: '#4c1d95',
                description: '‡∏™‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÑ‡∏î‡∏ã‡πå - ‡πÉ‡∏ä‡πâ‡∏Ü‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡∏∞‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå'
            },
            'CuSO4': {
                name: '‡∏Ñ‡∏≠‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡∏ã‡∏±‡∏•‡πÄ‡∏ü‡∏ï',
                mw: 249.68,
                molarity: 0.3,
                volume: 300,
                color: '#0ea5e9',
                powderColor: '#0284c7',
                description: '‡πÄ‡∏Å‡∏•‡∏∑‡∏≠‡∏ó‡∏≠‡∏á‡πÅ‡∏î‡∏á - ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡∏£‡∏Ü‡πà‡∏≤‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡∏£‡∏≤‡πÅ‡∏•‡∏∞‡∏õ‡∏∏‡πã‡∏¢'
            },
            'NaOH': {
                name: '‡πÇ‡∏ã‡πÄ‡∏î‡∏µ‡∏¢‡∏°‡πÑ‡∏Æ‡∏î‡∏£‡∏≠‡∏Å‡πÑ‡∏ã‡∏î‡πå',
                mw: 40.00,
                molarity: 0.1,
                volume: 1000,
                color: '#6b7280',
                powderColor: '#f3f4f6',
                description: '‡πÇ‡∏ã‡∏î‡∏≤‡πÑ‡∏ü - ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏ö‡∏π‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©'
            },
            'HCl': {
                name: '‡∏Å‡∏£‡∏î‡πÑ‡∏Æ‡πÇ‡∏î‡∏£‡∏Ñ‡∏•‡∏≠‡∏£‡∏¥‡∏Å',
                mw: 36.46,
                molarity: 0.25,
                volume: 400,
                color: '#fbbf24',
                powderColor: '#f59e0b',
                description: '‡∏Å‡∏£‡∏î‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô - ‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£'
            }
        };

        let currentStep = 1;
        let selectedCompound = 'NaCl';
        let correctMass = 0;
        let currentMass = 0;
        let score = 0;
        
        const totalSteps = 5;

        function updateProblem() {
            selectedCompound = document.getElementById('compound-select').value;
            const compound = compounds[selectedCompound];
            document.getElementById('display-compound').textContent = selectedCompound;
            document.getElementById('display-molarity').textContent = `${compound.molarity} M`;
            document.getElementById('display-volume').textContent = `${compound.volume} mL`;
            document.getElementById('compound-details').textContent = `${selectedCompound} ‡∏°‡∏µ‡∏°‡∏ß‡∏•‡πÇ‡∏°‡πÄ‡∏•‡∏Å‡∏∏‡∏• = ${compound.mw} g/mol`;
        }

        function nextStep(step) {
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(`step-${step}`).classList.remove('hidden');
            currentStep = step;
            document.getElementById('progress-bar').style.width = `${(step / totalSteps) * 100}%`;
            document.getElementById('progress-text').textContent = `‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà ${step}/${totalSteps}`;
            
            if (step === 2) {
                const compound = compounds[selectedCompound];
                document.getElementById('calc-compound').textContent = selectedCompound;
                document.getElementById('calc-molarity').textContent = compound.molarity;
                document.getElementById('calc-volume').textContent = compound.volume;
                document.getElementById('calc-mw').textContent = compound.mw;
                
                const volumeLiters = compound.volume / 1000;
                const moles = compound.molarity * volumeLiters;
                correctMass = moles * compound.mw;

                // Make all input fields for calculation empty
                document.getElementById('volume-input').value = '';
                document.getElementById('volume-liters').value = '';
                document.getElementById('molarity-input').value = '';
                document.getElementById('volume-for-moles').value = '';
                document.getElementById('moles-calc').value = '';
                document.getElementById('moles-for-mass').value = '';
                document.getElementById('mw-input').value = '';
                document.getElementById('mass-calc').value = '';
                
                document.getElementById('calculation-feedback').classList.add('hidden');
                document.getElementById('next-btn-calc').classList.add('hidden');
            }
            
            if (step === 3) {
                const compound = compounds[selectedCompound];
                document.getElementById('required-mass').textContent = correctMass.toFixed(2);
                document.getElementById('weighing-progress').style.width = '0%';
                document.getElementById('scale-display').textContent = '0.00 g';
                document.getElementById('weighing-status').textContent = '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ä‡∏±‡πà‡∏á‡∏™‡∏≤‡∏£';
                document.getElementById('powder-on-scale').style.opacity = '0';
                document.getElementById('next-btn-weighing').classList.add('hidden');
                currentMass = 0;
            }

            if (step === 4) {
                document.getElementById('solution-level').style.backgroundColor = compounds[selectedCompound].color;
                document.getElementById('powder-particles').style.color = compounds[selectedCompound].powderColor;
                resetStep4();
                const q1Radios = document.querySelectorAll('input[name="q1"]');
                q1Radios.forEach(radio => radio.checked = false); // Reset radio
                document.getElementById('q1-feedback').classList.add('hidden');
                document.getElementById('next-btn-1').classList.add('hidden');
            }

            if (step === 5) {
                document.getElementById('target-volume-label').textContent = compounds[selectedCompound].volume;
                document.getElementById('target-volume-display').textContent = compounds[selectedCompound].volume;
                document.getElementById('final-solution').style.backgroundColor = compounds[selectedCompound].color;
                updateFinalVolumeDisplay();
                const q2Radios = document.querySelectorAll('input[name="q2"]');
                q2Radios.forEach(radio => radio.checked = false); // Reset radio
                document.getElementById('q2-feedback').classList.add('hidden');
                document.getElementById('next-btn-2').classList.add('hidden');
            }
        }

        function previousStep(step) {
            nextStep(step);
        }

        function checkCalculation() {
            const compound = compounds[selectedCompound];
            const volumeLiters = compound.volume / 1000;
            const moles = compound.molarity * volumeLiters;
            const calculatedMass = moles * compound.mw;
            
            const vLitersCorrect = Math.abs(parseFloat(document.getElementById('volume-liters').value) - volumeLiters) < 0.001;
            const molesCorrect = Math.abs(parseFloat(document.getElementById('moles-calc').value) - moles) < 0.0001;
            const massCorrect = Math.abs(parseFloat(document.getElementById('mass-calc').value) - calculatedMass) < 0.01;

            const feedbackEl = document.getElementById('calculation-feedback');
            
            let tempScore = 0;
            let feedbackText = '<strong>‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô:</strong><br>';
            
            // Check each input individually
            const volumeInput = parseFloat(document.getElementById('volume-input').value);
            const volumeLitersInput = parseFloat(document.getElementById('volume-liters').value);
            const molarityInput = parseFloat(document.getElementById('molarity-input').value);
            const volumeForMolesInput = parseFloat(document.getElementById('volume-for-moles').value);
            const molesCalcInput = parseFloat(document.getElementById('moles-calc').value);
            const molesForMassInput = parseFloat(document.getElementById('moles-for-mass').value);
            const mwInput = parseFloat(document.getElementById('mw-input').value);
            const massCalcInput = parseFloat(document.getElementById('mass-calc').value);

            // Logic to check each box
            const checkVolML = !isNaN(volumeInput) && volumeInput === compound.volume;
            const checkVolLiters = !isNaN(volumeLitersInput) && Math.abs(volumeLitersInput - volumeLiters) < 0.001;
            const checkMolarity = !isNaN(molarityInput) && molarityInput === compound.molarity;
            const checkVolForMoles = !isNaN(volumeForMolesInput) && Math.abs(volumeForMolesInput - volumeLiters) < 0.001;
            const checkMolesCalc = !isNaN(molesCalcInput) && Math.abs(molesCalcInput - moles) < 0.0001;
            const checkMolesForMass = !isNaN(molesForMassInput) && Math.abs(molesForMassInput - moles) < 0.0001;
            const checkMw = !isNaN(mwInput) && mwInput === compound.mw;
            const checkMassCalc = !isNaN(massCalcInput) && Math.abs(massCalcInput - calculatedMass) < 0.01;

            let numCorrect = 0;
            if (checkVolML) numCorrect++;
            if (checkVolLiters) numCorrect++;
            if (checkMolarity) numCorrect++;
            if (checkVolForMoles) numCorrect++;
            if (checkMolesCalc) numCorrect++;
            if (checkMolesForMass) numCorrect++;
            if (checkMw) numCorrect++;
            if (checkMassCalc) numCorrect++;
            
            score = numCorrect;

            feedbackText = `<strong>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•:</strong> ‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å ${numCorrect} ‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 8 ‡∏ä‡πà‡∏≠‡∏á`;
            
            feedbackEl.innerHTML = `<div class="bg-green-100 text-green-700 p-3 rounded-lg">${feedbackText}</div>`;
            feedbackEl.classList.remove('hidden');

            document.getElementById('next-btn-calc').classList.remove('hidden');
        }

        function addPowder() {
            if (currentMass >= correctMass) {
                document.getElementById('weighing-status').textContent = '‡∏™‡∏≤‡∏£‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß';
                document.getElementById('weighing-progress').style.width = '100%';
                document.getElementById('next-btn-weighing').classList.remove('hidden');
                return;
            }
            
            const addedMass = (Math.random() * 0.5) + 0.5;
            currentMass += addedMass;
            if (currentMass > correctMass) {
                currentMass = correctMass;
            }

            const percentage = (currentMass / correctMass) * 100;
            document.getElementById('scale-display').textContent = `${currentMass.toFixed(2)} g`;
            document.getElementById('weighing-progress').style.width = `${percentage}%`;
            
            document.getElementById('powder-on-scale').style.opacity = '1';
            document.getElementById('weighing-status').textContent = `‡∏ä‡∏±‡πà‡∏á‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ ${currentMass.toFixed(2)} g`;

            if (currentMass >= correctMass) {
                document.getElementById('weighing-status').textContent = '‡∏ä‡∏±‡πà‡∏á‡∏™‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏Ñ‡∏£‡∏ö‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß!';
                document.getElementById('next-btn-weighing').classList.remove('hidden');
            }
        }
        
        let powderAdded = false;

        function resetStep4() {
            powderAdded = false;
            document.getElementById('solution-level').style.height = '0%';
            document.getElementById('powder-particles').innerHTML = '';
            document.getElementById('add-salt-btn').disabled = false;
            document.getElementById('add-water-btn').disabled = true;
            document.getElementById('stir-solution-btn').disabled = true;
            document.getElementById('dissolving-status').textContent = '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏™‡∏≤‡∏£';
        }

        function addSalt() {
            if (powderAdded) return;
            
            const powderContainer = document.getElementById('powder-particles');
            const powderColor = compounds[selectedCompound].powderColor;

            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.classList.add('powder-particle');
                particle.style.width = `${Math.random() * 5 + 3}px`;
                particle.style.height = particle.style.width;
                particle.style.left = `${Math.random() * 80 + 10}%`;
                particle.style.top = `-20px`;
                powderContainer.appendChild(particle);

                setTimeout(() => {
                    particle.style.transform = 'translateY(100px)';
                    particle.style.transition = 'transform 1.5s ease-in';
                }, i * 50); 
            }
            powderAdded = true;
            document.getElementById('dissolving-status').textContent = '‡πÄ‡∏ï‡∏¥‡∏°‡∏ú‡∏á‡∏™‡∏≤‡∏£‡∏•‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß';
            document.getElementById('add-salt-btn').disabled = true;
            document.getElementById('add-water-btn').disabled = false;
        }

        function addWater() {
            if (!powderAdded) {
                document.getElementById('dissolving-status').textContent = '‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ï‡∏¥‡∏°‡∏™‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô!';
                return;
            }
            document.getElementById('solution-level').style.height = `55%`;
            document.getElementById('dissolving-status').textContent = `‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡∏•‡∏á‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß`;
            document.getElementById('add-water-btn').disabled = true;
            document.getElementById('stir-solution-btn').disabled = false;
        }

        function stirSolution() {
            const stirringRod = document.getElementById('stirring-rod');
            if (stirringRod.classList.contains('active')) {
                return;
            }

            stirringRod.classList.add('active');
            document.getElementById('dissolving-status').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏ô‡∏™‡∏≤‡∏£...';

            const powderParticles = document.querySelectorAll('.powder-particle');
            powderParticles.forEach((particle, index) => {
                setTimeout(() => {
                    particle.style.transition = 'opacity 1s ease-out';
                    particle.style.opacity = '0';
                    particle.style.display = 'none';
                }, index * 50 + 1000);
            });
            
            setTimeout(() => {
                stirringRod.classList.remove('active');
                document.getElementById('dissolving-status').textContent = '‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß';
            }, 3000);
        }

        function checkAnswer(questionNumber) {
            let feedbackEl, correctValue;
            if (questionNumber === 1) {
                feedbackEl = document.getElementById('q1-feedback');
                correctValue = 'b';
                const userAnswer = document.querySelector('input[name="q1"]:checked')?.value;
                if (userAnswer === correctValue) {
                    feedbackEl.innerHTML = '<div class="bg-green-100 text-green-700 p-3 rounded-lg"><p class="font-semibold">‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! (+1 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)</p></div>';
                    score += 1;
                } else {
                    feedbackEl.innerHTML = '<div class="bg-red-100 text-red-700 p-3 rounded-lg"><p class="font-semibold">‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏•‡∏≠‡∏á‡∏î‡∏π‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p></div>';
                }
                document.getElementById('next-btn-1').classList.remove('hidden');
            } else if (questionNumber === 2) {
                feedbackEl = document.getElementById('q2-feedback');
                correctValue = 'a';
                const userAnswer = document.querySelector('input[name="q2"]:checked')?.value;
                if (userAnswer === correctValue) {
                    feedbackEl.innerHTML = '<div class="bg-green-100 text-green-700 p-3 rounded-lg"><p class="font-semibold">‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! (+1 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)</p></div>';
                    score += 1;
                } else {
                    feedbackEl.innerHTML = '<div class="bg-red-100 text-red-700 p-3 rounded-lg"><p class="font-semibold">‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡∏•‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏î‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏î‡∏π‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</p></div>';
                }
                document.getElementById('next-btn-2').classList.remove('hidden');
            }
            feedbackEl.classList.remove('hidden');
        }
        
        let currentVolume = 0;
        let targetVolume = 0;
        let transferred = false;
        let volumeCorrect = false;

        function transferSolution() {
            if (!transferred) {
                document.getElementById('final-status').textContent = '‡∏¢‡πâ‡∏≤‡∏¢‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏•‡∏á‡πÉ‡∏ô‡∏Ç‡∏ß‡∏î‡∏ß‡∏±‡∏î‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£';
                currentVolume = compounds[selectedCompound].volume * 0.8;
                targetVolume = compounds[selectedCompound].volume;
                updateFinalVolumeDisplay();
                transferred = true;
            } else {
                document.getElementById('final-status').textContent = '‡∏¢‡πâ‡∏≤‡∏¢‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß';
            }
        }
        
        function addMoreWater() {
            if (transferred) {
                document.getElementById('final-status').textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£...';
                currentVolume = targetVolume;
                updateFinalVolumeDisplay();
                document.getElementById('meniscus-line').style.opacity = '1';
                volumeCorrect = true;
            } else {
                document.getElementById('final-status').textContent = '‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡πâ‡∏≤‡∏¢‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡∏Å‡πà‡∏≠‡∏ô!';
            }
        }
        
        function finalMix() {
            if (volumeCorrect) {
                const flask = document.getElementById('volumetric-flask');
                const solution = document.getElementById('final-solution');
                const finalStatus = document.getElementById('final-status');
                const finalMixBtn = document.getElementById('final-mix-btn');

                flask.classList.add('shake');
                solution.style.backgroundColor = '#87CEEB';
                finalStatus.textContent = '‡∏õ‡∏¥‡∏î‡∏à‡∏∏‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏£‡∏•‡∏∞‡∏•‡∏≤‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡∏î‡∏µ';

                setTimeout(() => {
                    flask.classList.remove('shake');
                    finalStatus.textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                    finalMixBtn.disabled = true;
                }, 1000); 

            } else {
                document.getElementById('final-status').textContent = '‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡πÉ‡∏´‡πâ‡∏ñ‡∏∂‡∏á‡∏Ç‡∏µ‡∏î‡∏ö‡∏≠‡∏Å‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡πà‡∏≠‡∏ô!';
            }
        }

        function updateFinalVolumeDisplay() {
            const heightPercentage = (currentVolume / compounds[selectedCompound].volume) * 80;
            document.getElementById('final-solution').style.height = `${heightPercentage}%`;
            document.getElementById('current-volume').textContent = currentVolume.toFixed(0);
            document.getElementById('target-volume-display').textContent = targetVolume;
        }

        function showCompletion() {
            const finalResultsEl = document.getElementById('final-results');
            finalResultsEl.innerHTML = `
                <p><strong>‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°:</strong> ${compounds[selectedCompound].name} (${selectedCompound})</p>
                <p><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô:</strong> ${compounds[selectedCompound].molarity} M</p>
                <p><strong>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£:</strong> ${compounds[selectedCompound].volume} mL</p>
                <p><strong>‡∏°‡∏ß‡∏•‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:</strong> ${correctMass.toFixed(2)} g</p>
            `;
            document.getElementById('total-score').textContent = score;
            document.getElementById('completion-modal').classList.remove('hidden');
        }

        function resetGame() {
            location.reload();
        }

        document.addEventListener('DOMContentLoaded', () => {
            updateProblem();
        });
    </script>
</body>
</html>
